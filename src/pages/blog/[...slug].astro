---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const guides = await getCollection('guides');
  return guides.map((guide) => ({
    params: { slug: guide.slug },
    props: { guide },
  }));
}

const { guide } = Astro.props;
const { Content } = await guide.render();

// Create schema for SEO
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": guide.data.title,
  "description": guide.data.description,
  "author": {
    "@type": "Organization",
    "name": "GTME JET",
    "url": "https://www.gtmejet.com"
  },
  "publisher": {
    "@type": "Organization",
    "name": "GTME JET",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.gtmejet.com/favicon.svg"
    }
  },
  "datePublished": guide.data.publishDate.toISOString(),
  "dateModified": guide.data.lastUpdated.toISOString(),
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": `https://www.gtmejet.com/blog/${guide.slug}`
  },
  "proficiencyLevel": guide.data.difficulty,
  "timeRequired": `PT${guide.data.timeToImplement}M`
};

// FAQ Schema for enriched SEO
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What impact does technical debt in revenue systems have on business growth and efficiency?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Technical debt in revenue systems can drag down business growth and throw a wrench into operational efficiency. It often results in increased costs, thanks to inefficiencies, outdated workflows, and the constant need for system upkeep. These challenges can make scaling your business harder and stifle opportunities to innovate. On top of that, technical debt can lead to fragmented data and unreliable systems, which can negatively impact customer experiences and hinder informed decision-making."
      }
    },
    {
      "@type": "Question",
      "name": "How can I identify and fix data sync issues in my revenue system?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Data syncing hiccups can throw a wrench into your revenue operations. Keep an eye out for inconsistent or missing data, like mismatched customer records or incomplete transaction details. Pay attention to error logs or system alerts that might signal failed integrations. Audit your integrations to ensure all tools are connected correctly, standardize data formats across systems, and use monitoring tools to track data sync activity and flag errors in real time."
      }
    },
    {
      "@type": "Question",
      "name": "What are the advantages of using specialized services like GTME Jet for cleaning up technical issues?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Specialized services such as GTME Jet excel at pinpointing inefficiencies, outdated workflows, and integration hurdles within your revenue systems. Their expertise allows them to tackle technical debt in ways that often surpass the capabilities of in-house teams. By providing customized insights and practical strategies, these services can help fine-tune your operations, ensuring your revenue systems operate seamlessly."
      }
    },
    {
      "@type": "Question",
      "name": "What are the most common signs of technical debt in revenue systems?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The most common signs include data sync failures between sales tools, inaccurate or outdated revenue reports, reliance on manual processes and spreadsheets, broken or slow workflow automations, security and compliance problems, difficulty adding new sales tools, and missing system documentation. These issues compound over time and can significantly impact business growth and operational efficiency."
      }
    },
    {
      "@type": "Question",
      "name": "How much does technical debt typically cost businesses?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Companies burdened by technical debt often allocate 70-80% of their IT budget just to keep systems operational, leaving little room for innovation or strategic improvements. Organizations in the top 20th percentile for technical debt score see 20% higher revenue growth compared to those in the bottom 20th percentile. Companies with high technical debt are also 40% more likely to have incomplete or abandoned IT modernization efforts."
      }
    },
    {
      "@type": "Question",
      "name": "How long does it typically take to clean up technical debt in revenue systems?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The timeline depends on the severity of technical debt and system complexity. Quick wins like automating manual processes or fixing specific integration issues can be achieved in weeks. However, comprehensive cleanup involving system audits, rebuilding integrations, and establishing proper documentation typically takes 2-6 months. Using specialized services can accelerate this timeline by leveraging proven frameworks and experienced teams."
      }
    },
    {
      "@type": "Question",
      "name": "Should I fix technical debt internally or hire external help?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This depends on your internal resources and expertise. In-house teams may lack deep expertise across multiple platforms and revenue operations best practices, which can make cleanup efforts slower and riskier. Specialized services like GTME Jet provide experienced teams that have solved similar problems across various organizations, enabling faster implementation with less risk. External services are particularly valuable when you need expertise that would take significant time to build internally while technical debt continues to accumulate."
      }
    },
    {
      "@type": "Question",
      "name": "What's the best way to prevent technical debt from accumulating?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Prevention requires establishing ongoing maintenance practices: conduct regular system health checks, implement proactive monitoring and alerts, maintain comprehensive living documentation, standardize API integration practices before adding new tools, enforce data quality standards, schedule incremental updates rather than large overhauls, and invest in proper training for teams managing revenue systems. The key is shifting from reactive firefighting to proactive system management."
      }
    }
  ]
};

// Combine schemas
const schema = [articleSchema, faqSchema];
---

<BaseLayout
  title={guide.data.title}
  description={guide.data.description}
  schema={schema}
>
  <style>
    .article-header {
      padding: 2rem 0;
      border-bottom: 1px solid #e5e7eb;
    }

    .article-title {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
      line-height: 1.2;
      color: #1a1a1a;
    }

    .article-meta {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      font-size: 0.875rem;
      color: #6b7280;
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 0.625rem;
      background: #f3f4f6;
      color: #4b5563;
      border-radius: 0.25rem;
      font-weight: 600;
      text-transform: capitalize;
    }

    .badge.ai {
      background: #dbeafe;
      color: #1e40af;
    }

    .article-content {
      padding: 3rem 0;
      max-width: 800px;
      margin: 0 auto;
    }

    .article-content :global(h2) {
      font-size: 1.875rem;
      font-weight: 700;
      margin-top: 2.5rem;
      margin-bottom: 1rem;
      color: #1a1a1a;
    }

    .article-content :global(h3) {
      font-size: 1.5rem;
      font-weight: 600;
      margin-top: 2rem;
      margin-bottom: 0.75rem;
      color: #1a1a1a;
    }

    .article-content :global(p) {
      margin-bottom: 1.25rem;
      line-height: 1.75;
      color: #374151;
    }

    .article-content :global(ul),
    .article-content :global(ol) {
      margin-bottom: 1.25rem;
      padding-left: 1.5rem;
    }

    .article-content :global(li) {
      margin-bottom: 0.5rem;
      line-height: 1.75;
      color: #374151;
    }

    .article-content :global(code) {
      background: #f3f4f6;
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      font-size: 0.875em;
      font-family: 'Monaco', 'Courier New', monospace;
    }

    .article-content :global(pre) {
      background: #1f2937;
      color: #f9fafb;
      padding: 1rem;
      border-radius: 0.5rem;
      overflow-x: auto;
      margin-bottom: 1.25rem;
    }

    .article-content :global(pre code) {
      background: none;
      padding: 0;
      color: inherit;
    }

    .article-content :global(blockquote) {
      border-left: 4px solid #667eea;
      padding-left: 1rem;
      margin: 1.5rem 0;
      font-style: italic;
      color: #4b5563;
    }

    /* YouTube iframe embeds */
    .article-content :global(iframe) {
      width: 100%;
      max-width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 0.5rem;
      margin: 2rem 0;
      border: none;
    }

    /* FAQ styling */
    .article-content :global(details) {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .article-content :global(summary) {
      font-weight: 600;
      cursor: pointer;
      color: #1a1a1a;
      list-style: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .article-content :global(summary::-webkit-details-marker) {
      display: none;
    }

    .article-content :global(summary::after) {
      content: '+';
      font-size: 1.5rem;
      font-weight: 400;
      color: #667eea;
    }

    .article-content :global(details[open] summary::after) {
      content: '‚àí';
    }

    .article-content :global(details p) {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid #e5e7eb;
    }

    /* Mid-article CTA box */
    .article-content :global(.cta-box) {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2rem;
      border-radius: 0.75rem;
      margin: 3rem 0;
      text-align: center;
    }

    .article-content :global(.cta-box h3) {
      color: white;
      font-size: 1.75rem;
      margin-bottom: 1rem;
      margin-top: 0;
    }

    .article-content :global(.cta-box p) {
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 1.5rem;
      font-size: 1.125rem;
    }

    .article-content :global(.cta-box a) {
      display: inline-block;
      background: white;
      color: #667eea;
      padding: 0.75rem 2rem;
      border-radius: 50px;
      font-weight: 600;
      text-decoration: none;
      transition: transform 0.2s;
    }

    .article-content :global(.cta-box a:hover) {
      transform: scale(1.05);
    }

    @media (max-width: 768px) {
      .article-title {
        font-size: 1.875rem;
      }

      .article-content :global(.cta-box) {
        padding: 1.5rem;
      }

      .article-content :global(.cta-box h3) {
        font-size: 1.5rem;
      }
    }
  </style>

  <article>
    <header class="article-header">
      <div class="container">
        <h1 class="article-title">{guide.data.title}</h1>
        <div class="article-meta">
          <span class="badge">{guide.data.tool}</span>
          <span class="badge">{guide.data.useCase}</span>
          <span class="badge">{guide.data.difficulty}</span>
          <span>‚è±Ô∏è {guide.data.timeToImplement} min read</span>
          <span>üìÖ {guide.data.publishDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>
        </div>
      </div>
    </header>

    <div class="article-content">
      <div class="container">
        <Content />
      </div>
    </div>
  </article>
</BaseLayout>
